IVR模块介绍 
============================

IVR流程由多个IVR模块经过连线后组成，具有非常高的可定制性。下面将依次介绍开始-放音-收号-分支-转人工-转外线-定义变量-函数-子流程-智能导航-结束各个模块的详细功能。

开始模块 
-------------------------

**每个IVR流程，必须以该模块为起始模块且无法编辑不可删除。**

放音模块 
-------------------------

**用于播放音频文件 或 文字转语音，通常用作开场的欢迎语和模块间的过度使用。** 

* 模块名称，可根据需要自定义。

  

* 语音提示-使用音频文件

  * 下拉菜单中显示已上传的私有音频，以及呼叫中心提供的公有音频。

    
  

  

  ![21](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/2827978161/p263949.png)
  * 如果列表中没有您需要的音频文件，可点击 **上传音频** ，系统会打开新的标签页中，并进入到音频管理页面，您可以在这里添加新的音频，上传成功后返回原来的标签页中，重新点击下拉菜单会获取最新的音频列表。

    
  

  




<!-- -->

* 语音提示-文字转语音

  * 单次转换最多输入200个字符。

    
  
  * 可已在文本库中引用参数，输入'空格+$'选择相应参数。例如："你好 ${开始.callee}，欢迎使用阿里云呼叫中心。"

    
  

  




<!-- -->

* 点击 确定 按钮将提交。

  




收号模块 
-------------------------

**用于保存用户输入的按键内容，赋值给自定义参数，传递到分支模块进行处理。** 

![23](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/2827978161/p263951.png)

* 模块名称，可根据需要自定义。

  

* 语音提示-使用音频文件

  * 下拉菜单中显示已上传的私有音频，以及呼叫中心提供的公有音频。

    
  
  * 如果列表中没有您需要的音频文件，可点击 **上传音频** ，系统会打开新的标签页中，并进入到音频管理页面，您可以在这里添加新的音频，上传成功后返回原来的标签页中，重新点击下拉菜单会获取最新的音频列表。

    
  

  




<!-- -->

* 语音提示-文字转语音

  * 单次转换最多输入200个字符。

    
  
  * 可已在文本库中引用参数，输入'空格+$'选择相应参数。例如："你好 ${开始.callee}，欢迎使用阿里云呼叫中心。"

    
  

  




<!-- -->

* 语音提示循环播放最大次数：在用户一直没有按键的情况下，达到设定的循环次数后，将执行"收号失败"出口所连接的模块（默认为结束模块，即主动挂机）。这里次数不建议设置过大，否则由于主叫号码始终没有按键输入也没有挂机，会一直在呼入状态，对于按量付费用户呼入也是收费的。

  




<!-- -->

* 接收数字

  * 按键长度分为 **固定位数** 和 **长度区间** 两种，前者用于接收身份证、手机号码等固定位数的数字，当用户输入达到指定位数后，自动进入下一环节；后者用于接收动态长度位数的数字，当用户需输入#号，表示输入结束；建议配合语音提示。

    
  
  * 用户按键输入超时时间：在用户开始按键输入时，停顿时间达到此处设置的数值时，将重新播放背景音，并且需要重新进行按键输入。这里数值如果设置的较大，并且按键位数是不固定的，建议背景音中提示客户输入完毕后按#号键确认。

    
  

  




分支模块 
-------------------------

**根据参数的值，通过自定义的条件规则，匹配成功后进入下一个指定的模块，需搭配定义变量模块、收号模块、函数模块中的变量进行使用。** 

![23](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/2827978161/p263952.png)

* 模块名称，可根据需要自定义。

  

* 设置参数

  * **参数** 下拉菜单中显示为收音模块、函数模块中的参数和系统提供的参数。

    
  
  * **条件** 下拉菜单中共有九种条件可供选择。

    
  
  * **赋值** 可根据场景需要输入，并且可以引用参数，引用时使用${参数名}。

    
  
  * **描述** 为非必填项。

    
  
  * 点击 新增 按钮可新增一列条件设置项。

    
  

  




<!-- -->

* 点击 确定 按钮将提交。

  




转人工模块 
--------------------------

**该模块用于将客户来电转至相应的技能组，系统队列会根据该模块的优先级、技能组内客服状态以及客服在技能组内的等级，智能化的分配来电。** 

![32](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3827978161/p263956.png)

* 模块名称，可根据需要自定义。

  

* 语音提示-使用音频文件。

  * 下拉菜单中显示已上传的私有音频，以及呼叫中心提供的公有音频。

    
  
  * 如果列表中没有您需要的音频文件，可点击 **上传音频** ，系统会打开新的标签页中，并进入到音频管理页面，您可以在这里添加新的音频，上传成功后返回原来的标签页中，重新点击下拉菜单会获取最新的音频列表。

    
  

  




<!-- -->

* 语音提示-文字转语音

  * 单次转换最多输入200个字符。

    
  
  * 可已在文本库中引用参数，输入'空格+$'选择相应参数。例如："你好 ${开始.callee}，欢迎使用阿里云呼叫中心。"

    
  

  




![25](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3827978161/p263955.png)

* 人工接听

  * 在人工接听中可以选择技能组或智能坐席，当选择前者时在选择技能组的下拉菜单中显示为当前呼叫中心中所有的技能组列表，当进入到该模块时，来电将分配到选择的技能组中，然后再智能化的分配给技能组当中的坐席；选择后者是会提示选择指定坐席的userName，详情可参见IVR将来电转接到指定坐席的介绍。

    
  
  * 超时时间：默认值600秒，最大值3600秒，表示客户来电进入到该模块时，当坐席全忙，客户排队等待的时间超过设定的超时时间时，执行 **转人工超时** 的出口所连线的模块。推荐连接一个放音模块，友好的提示客户稍后再拨。

    
  
  * 优先级是对来电本身进行优先级打标，当坐席有多技能组的情况下，有来电进线时，优先级高的技能组将优先进线，然后根据技能组内坐席的等级进行分配来电。默认值为1，最大值为99。

    
  

  




![24](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3827978161/p263954.png)

* 熟人模式

  * 开启熟人模式后，将会查询一段时间内是否有联系过当前来电号码的坐席人员，然后将来电直接转接到对应的坐席人员，该坐席如果没有接听，来电将会转接到该模块所选择的技能组中。详情参见熟人模式。

    
  

  




<!-- -->

* 随路数据

  * 选择随路数据后，转人工成功时，会将此值传递给坐席端的软电话sdk。集成用户可以通过onCallEstablish钩子函数，拿到此数据。这些参数可以是系统参数，如_time,_date，也可以是与通信侧预先约定设置好的， 如_x_call_id, 为通信发送过来的携带在随路数据中XCallId，也可以是ivr中定义的其他参数，如收号模块中定义的接收用户按键输入的参数。

    
  

  




转外线模块 
--------------------------

**该模块用于将来电转接到外部电话。** 

![44](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3827978161/p263958.png)

* 模块名称，可根据需要自定义。

  

* 外呼号码，转外线时使用哪个号码外呼，下拉菜单中展示的为呼叫中心所有的可外呼号码列表。

  

* 转接号码，转外线时所转接的外部号码，可以是手机号码，也可以是固定电话，也可以取 **自定义参数** 。 **备注：如果转外线配置的外呼号码为阿里云呼叫中心申请的号码，因运营商外呼频次限制，一个被叫号码外呼5次/天，所有使用此功能的客户需要提供转接号码白名单，联系云呼服务支持（13148471489）否则将会触发运营商外呼策略，导致外呼失败。**

  

* 该模块在画布中有两个出口，说明如下：

  * 转外线成功，指的是系统外呼转接号码的动作已经实现，外呼是否成功由运营商控制，是否转外线成功云呼侧无法拿到结果，此出口建议连接到结束模块即可。

    
  
  * 转外线失败，系统转外线模块异常导致没有转外线成功，此出口建议连接到放音模块，友好的告知系统异常转接失败。

    
  

  




<!-- -->

* 建议：转外线相当于使用呼叫中心外呼，所以转外线模块成功时，会有大约三四秒的空档期，此空档期没有任何声音，之后才会播放转接号码的铃声；建议在转外线模块之前，增加一个放音模块，播放"正在呼叫，请稍后"，以防客户在空档期时挂机。

  




定义变量模块 
---------------------------

**可以进行自定义参数变量用于在IVR流程中进行传递，以满足不同的业务场景的使用。自定义参数，主要用于赋值，可在收号模块中将用户的输入赋值给自定义参数，也可以在放音、分支、函数、转外线模块中使用，详细说明请看每个模块的说明。引用时使用${参数名}。** 

![45](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3827978161/p263959.png)

* 模块名称，可根据需要自定义。

  

* 设置参数，参数和赋值为必填项。

  * 点击 新增 按钮可新增一列自定义参数。

    
  
  * 点击 删除 按钮可将当前行删除。

    
  

  




<!-- -->

* 点击 确定 按钮将提交。

  




函数模块 
-------------------------

**调用函数计算的函数，呼叫中心的IVR流程可以集成您的自有系统，实现客户的自助服务。例如订单查询，重置密码，身份验证等功能；例如下图，已查询余额为例。** 

![42](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3827978161/p263961.png)

* 模块名称，可根据需要自定义。

  

* 选择函数，下拉列表中的函数是通过云呼叫中心控制台添加的函数，例如上图中的，分别为 函数名称\|该函数所在的服务\|该函数服务所在的区域 。详细介绍请点击页面上的 **如何添加函数** 查看文档。

  

* 调用超时时间，调用您所选择函数时，最长的调用等待时间，如果在超时时间范围内函数没有返回，则执行函数调用失败的出口。

  

* 设置入参，调用函数时所携带的参数，目前最多设置10个入参；

  * 参数，即为参数名称；

    
  
  * 赋值，可以输入具体的值（字符串或者数字类型），也可以从下拉菜单中选择该IVR中的系统参数或者自定义参数，例如IVR中通过收号模块将用户输入的身份证号码保存到一个自定义参数上，在此处就可以选取该自定义参数。

    
  

  




<!-- -->

* 设置出参，该函数调用成功时，将返回值保存到一个自定义参数中，可以在其他模块中使用，比如可以在条件判断中通过一些逻辑比较做出不同的响应，或者是通过放音模块将结果播放出来。

  

* 设置出参多参数，根据函数返回对象分别赋值在自定义参数内，参数项对应的是自定义参数，赋值项对应的是函数内返回的对象中的key值，例如：函数返回 {title：'你好', name: '张三', age: 10}，则多参数配置如图所示，赋值项需要相关对应，在之后的模块中使用${l1}就可以取到对应的值。

  




**函数模块调用失败的出口，建议连接到一个转人工模块做兜底。** 

**详情参见：** [IVR函数管理]()

子流程模块 
--------------------------

**该模块用于在主流程中引入子流程，使得可以在主流程中跳入对应的子流程，子流程结束后再回到主流程中，借此可以拓展出功能更加丰富的IVR流程。** 

![52](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3827978161/p263962.png)

* 模块名称，可根据需要自定义。

  

* 选择子流程，选择您需要跳入的子流程，这里只展示 **已发布** **有更新, 未发布** 两个状态的子流程列表。

  

* 设置参数传递，主流程中的自定义参数及系统参数，可以与子流程中的自定义参数进行单向或双向传递，通过信息交换可以实现更加丰富的功能。这里主流程和子流程的参数均为系统自动获取，无法输入，这样可以降低IVR发布失败的概率。

  




**说明 ：** 子流程有更新，并且发布成功后，需要重新发布引用该子流程的主流程，才可最终生效。子流程中无法使用子流程模块，子流程画布中如果包含子流程模块，是无法发布的。 子流程中暂时无法使用短信模块和函数模块，系统参数中的_JOBID暂时无法获取，您可以自行从主流程中传递到子流程中来，以上两个问题，预计11月中旬可以解决。子主流程不能同时存在转人工模块，否则系统将会出现异常通话的情况（一通通话多次转人工队列导致会议等场景）。

智能导航模块 
---------------------------



**使用该模块首先需要开通智能语音导航，请到 智能语音导航控制台 参照页面提示操作即可。** 

**详情参见** [IVR智能导航模块使用说明]() **。**

结束模块 
-------------------------

**该模块为固定模块自动出现在画布中，作为IVR流程的结束，通常跟在转人工、条件判断、分支之后，不可编辑，直接在画布中连线即可**





